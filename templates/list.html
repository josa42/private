<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Kontakte</title>
	<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
	<style>
		body { font-family: Arial, sans-serif; margin: 20px; }
		.breadcrumb { margin-bottom: 20px; color: #666; }
		.breadcrumb a { color: #4CAF50; text-decoration: none; }
		.breadcrumb a:hover { text-decoration: underline; }
		.breadcrumb span { margin: 0 5px; }
		.header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; flex-wrap: wrap; gap: 10px; }
		.header h1 { margin: 0; }
		.header > div { display: flex; gap: 10px; flex-wrap: wrap; }
		table { border-collapse: collapse; width: 100%; overflow-x: auto; display: block; }
		thead, tbody { display: table; width: 100%; table-layout: fixed; }
		th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
		th { background-color: #4CAF50; color: white; }
		tr:hover { background-color: #f5f5f5; }
		tbody tr { cursor: pointer; }
		a { color: #4CAF50; text-decoration: none; }
		a:hover { text-decoration: underline; }
		.delete-link { color: #f44336; }
		.delete-link:hover { text-decoration: underline; }
		.action-icon { vertical-align: middle; font-size: 18px; margin-right: 4px; }
		.actions { white-space: nowrap; }
		.actions a { display: inline-flex; align-items: center; margin-right: 12px; }
		.btn { background-color: #4CAF50; color: white; padding: 10px 20px; 
		       border: none; border-radius: 4px; cursor: pointer; text-decoration: none;
		       display: inline-flex; align-items: center; white-space: nowrap; }
		.btn:hover { background-color: #45a049; }
		
		@media (max-width: 768px) {
			body { margin: 10px; }
			.header { flex-direction: column; align-items: stretch; }
			.header h1 { font-size: 1.5em; }
			.header > div { justify-content: stretch; }
			.btn { padding: 8px 12px; font-size: 14px; justify-content: center; }
			.btn .material-icons { font-size: 16px; }
			th, td { padding: 6px 4px; font-size: 14px; }
			.actions a { margin-right: 8px; }
			.action-icon { font-size: 20px; }
		}
	</style>
</head>
<body>
	<nav class="breadcrumb">
		<a href="/">Home</a>
		<span>›</span>
		<span>Kontakte</span>
	</nav>
	<div class="header">
		<h1>Kontakte</h1>
		<div>
			<form action="/contacts/normalize" method="POST" style="display: inline;" onsubmit="return confirm('Alle Telefonnummern normalisieren (0... → +49..., Leerzeichen einfügen)?')">
				<button type="submit" class="btn" style="background-color: #FF9800; margin-right: 10px;">
					<span class="material-icons" style="vertical-align: middle; font-size: 18px; margin-right: 4px;">auto_fix_high</span>
					Normalisieren
				</button>
			</form>
			<a href="/contacts/import" class="btn" style="margin-right: 10px; background-color: #2196F3;">
				<span class="material-icons" style="vertical-align: middle; font-size: 18px; margin-right: 4px;">file_upload</span>
				Import
			</a>
			<a href="/contacts/new" class="btn">Neuer Kontakt</a>
		</div>
	</div>
	<table>
		<tr>
			<th>Name</th>
			<th>Telefonnummer</th>
			<th style="width: 120px;">Aktionen</th>
		</tr>
		{{range $i, $c := .}}
		<tr onclick="window.location='/contacts/edit?id={{$i}}'">
			<td>
				{{if $c.CompanyName}}
					<strong>{{$c.CompanyName}}</strong>
				{{else if $c.FirstName}}
					{{$c.FirstName}} {{$c.LastName}}
				{{else}}
					-
				{{end}}
			</td>
			<td>{{$c.Phone.PhoneNumber}}</td>
			<td class="actions">
				<a href="/contacts/edit?id={{$i}}" onclick="event.stopPropagation()" title="Bearbeiten">
					<span class="material-icons action-icon">edit</span>
				</a>
				<a href="#" class="delete-link" onclick="event.stopPropagation(); if(confirm('Kontakt wirklich löschen?')) { var form = document.createElement('form'); form.method = 'POST'; form.action = '/contacts/edit'; var idInput = document.createElement('input'); idInput.type = 'hidden'; idInput.name = 'id'; idInput.value = '{{$i}}'; var actionInput = document.createElement('input'); actionInput.type = 'hidden'; actionInput.name = 'action'; actionInput.value = 'delete'; form.appendChild(idInput); form.appendChild(actionInput); document.body.appendChild(form); form.submit(); } return false;" title="Löschen">
					<span class="material-icons action-icon">delete</span>
				</a>
			</td>
		</tr>
		{{end}}
	</table>
</body>
</html>
